{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/*!\n * send\n * Copyright(c) 2012 TJ Holowaychuk\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar createError = require('http-errors')\nvar debug = require('debug')('send')\nvar deprecate = require('depd')('send')\nvar destroy = require('destroy')\nvar escapeHtml = require('escape-html')\n  , parseRange = require('range-parser')\n  , Stream = require('stream')\n  , mime = require('mime')\n  , fresh = require('fresh')\n  , path = require('path')\n  , fs = require('fs')\n  , normalize = path.normalize\n  , join = path.join\nvar etag = require('etag')\nvar EventEmitter = require('events').EventEmitter;\nvar ms = require('ms');\nvar onFinished = require('on-finished')\nvar statuses = require('statuses')\n\n/**\n * Variables.\n */\nvar extname = path.extname\nvar maxMaxAge = 60 * 60 * 24 * 365 * 1000; // 1 year\nvar resolve = path.resolve\nvar sep = path.sep\nvar toString = Object.prototype.toString\nvar upPathRegexp = /(?:^|[\\\\\\/])\\.\\.(?:[\\\\\\/]|$)/\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = send\nmodule.exports.mime = mime\n\n/**\n * Shim EventEmitter.listenerCount for node.js < 0.10\n */\n\n/* istanbul ignore next */\nvar listenerCount = EventEmitter.listenerCount\n  || function(emitter, type){ return emitter.listeners(type).length; };\n\n/**\n * Return a `SendStream` for `req` and `path`.\n *\n * @param {object} req\n * @param {string} path\n * @param {object} [options]\n * @return {SendStream}\n * @public\n */\n\nfunction send(req, path, options) {\n  return new SendStream(req, path, options);\n}\n\n/**\n * Initialize a `SendStream` with the given `path`.\n *\n * @param {Request} req\n * @param {String} path\n * @param {object} [options]\n * @private\n */\n\nfunction SendStream(req, path, options) {\n  var opts = options || {}\n\n  this.options = opts\n  this.path = path\n  this.req = req\n\n  this._etag = opts.etag !== undefined\n    ? Boolean(opts.etag)\n    : true\n\n  this._dotfiles = opts.dotfiles !== undefined\n    ? opts.dotfiles\n    : 'ignore'\n\n  if (this._dotfiles !== 'ignore' && this._dotfiles !== 'allow' && this._dotfiles !== 'deny') {\n    throw new TypeError('dotfiles option must be \"allow\", \"deny\", or \"ignore\"')\n  }\n\n  this._hidden = Boolean(opts.hidden)\n\n  if (opts.hidden !== undefined) {\n    deprecate('hidden: use dotfiles: \\'' + (this._hidden ? 'allow' : 'ignore') + '\\' instead')\n  }\n\n  // legacy support\n  if (opts.dotfiles === undefined) {\n    this._dotfiles = undefined\n  }\n\n  this._extensions = opts.extensions !== undefined\n    ? normalizeList(opts.extensions, 'extensions option')\n    : []\n\n  this._index = opts.index !== undefined\n    ? normalizeList(opts.index, 'index option')\n    : ['index.html']\n\n  this._lastModified = opts.lastModified !== undefined\n    ? Boolean(opts.lastModified)\n    : true\n\n  this._maxage = opts.maxAge || opts.maxage\n  this._maxage = typeof this._maxage === 'string'\n    ? ms(this._maxage)\n    : Number(this._maxage)\n  this._maxage = !isNaN(this._maxage)\n    ? Math.min(Math.max(0, this._maxage), maxMaxAge)\n    : 0\n\n  this._root = opts.root\n    ? resolve(opts.root)\n    : null\n\n  if (!this._root && opts.from) {\n    this.from(opts.from)\n  }\n}\n\n/**\n * Inherits from `Stream.prototype`.\n */\n\nSendStream.prototype.__proto__ = Stream.prototype;\n\n/**\n * Enable or disable etag generation.\n *\n * @param {Boolean} val\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.etag = deprecate.function(function etag(val) {\n  val = Boolean(val);\n  debug('etag %s', val);\n  this._etag = val;\n  return this;\n}, 'send.etag: pass etag as option');\n\n/**\n * Enable or disable \"hidden\" (dot) files.\n *\n * @param {Boolean} path\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.hidden = deprecate.function(function hidden(val) {\n  val = Boolean(val);\n  debug('hidden %s', val);\n  this._hidden = val;\n  this._dotfiles = undefined\n  return this;\n}, 'send.hidden: use dotfiles option');\n\n/**\n * Set index `paths`, set to a falsy\n * value to disable index support.\n *\n * @param {String|Boolean|Array} paths\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.index = deprecate.function(function index(paths) {\n  var index = !paths ? [] : normalizeList(paths, 'paths argument');\n  debug('index %o', paths);\n  this._index = index;\n  return this;\n}, 'send.index: pass index as option');\n\n/**\n * Set root `path`.\n *\n * @param {String} path\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.root = function(path){\n  path = String(path);\n  this._root = resolve(path)\n  return this;\n};\n\nSendStream.prototype.from = deprecate.function(SendStream.prototype.root,\n  'send.from: pass root as option');\n\nSendStream.prototype.root = deprecate.function(SendStream.prototype.root,\n  'send.root: pass root as option');\n\n/**\n * Set max-age to `maxAge`.\n *\n * @param {Number} maxAge\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.maxage = deprecate.function(function maxage(maxAge) {\n  maxAge = typeof maxAge === 'string'\n    ? ms(maxAge)\n    : Number(maxAge);\n  if (isNaN(maxAge)) maxAge = 0;\n  if (Infinity == maxAge) maxAge = 60 * 60 * 24 * 365 * 1000;\n  debug('max-age %d', maxAge);\n  this._maxage = maxAge;\n  return this;\n}, 'send.maxage: pass maxAge as option');\n\n/**\n * Emit error with `status`.\n *\n * @param {number} status\n * @param {Error} [error]\n * @private\n */\n\nSendStream.prototype.error = function error(status, error) {\n  // emit if listeners instead of responding\n  if (listenerCount(this, 'error') !== 0) {\n    return this.emit('error', createError(error, status, {\n      expose: false\n    }))\n  }\n\n  var res = this.res\n  var msg = statuses[status]\n\n  // wipe all existing headers\n  res._headers = null\n\n  // send basic response\n  res.statusCode = status\n  res.setHeader('Content-Type', 'text/plain; charset=UTF-8')\n  res.setHeader('Content-Length', Buffer.byteLength(msg))\n  res.setHeader('X-Content-Type-Options', 'nosniff')\n  res.end(msg)\n}\n\n/**\n * Check if the pathname ends with \"/\".\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.hasTrailingSlash = function(){\n  return '/' == this.path[this.path.length - 1];\n};\n\n/**\n * Check if this is a conditional GET request.\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isConditionalGET = function(){\n  return this.req.headers['if-none-match']\n    || this.req.headers['if-modified-since'];\n};\n\n/**\n * Strip content-* header fields.\n *\n * @private\n */\n\nSendStream.prototype.removeContentHeaderFields = function removeContentHeaderFields() {\n  var res = this.res\n  var headers = Object.keys(res._headers || {})\n\n  for (var i = 0; i < headers.length; i++) {\n    var header = headers[i]\n    if (header.substr(0, 8) === 'content-' && header !== 'content-location') {\n      res.removeHeader(header)\n    }\n  }\n}\n\n/**\n * Respond with 304 not modified.\n *\n * @api private\n */\n\nSendStream.prototype.notModified = function(){\n  var res = this.res;\n  debug('not modified');\n  this.removeContentHeaderFields();\n  res.statusCode = 304;\n  res.end();\n};\n\n/**\n * Raise error that headers already sent.\n *\n * @api private\n */\n\nSendStream.prototype.headersAlreadySent = function headersAlreadySent(){\n  var err = new Error('Can\\'t set headers after they are sent.');\n  debug('headers already sent');\n  this.error(500, err);\n};\n\n/**\n * Check if the request is cacheable, aka\n * responded with 2xx or 304 (see RFC 2616 section 14.2{5,6}).\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isCachable = function(){\n  var res = this.res;\n  return (res.statusCode >= 200 && res.statusCode < 300) || 304 == res.statusCode;\n};\n\n/**\n * Handle stat() error.\n *\n * @param {Error} error\n * @private\n */\n\nSendStream.prototype.onStatError = function onStatError(error) {\n  switch (error.code) {\n    case 'ENAMETOOLONG':\n    case 'ENOENT':\n    case 'ENOTDIR':\n      this.error(404, error)\n      break\n    default:\n      this.error(500, error)\n      break\n  }\n}\n\n/**\n * Check if the cache is fresh.\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isFresh = function(){\n  return fresh(this.req.headers, this.res._headers);\n};\n\n/**\n * Check if the range is fresh.\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isRangeFresh = function isRangeFresh(){\n  var ifRange = this.req.headers['if-range'];\n\n  if (!ifRange) return true;\n\n  return ~ifRange.indexOf('\"')\n    ? ~ifRange.indexOf(this.res._headers['etag'])\n    : Date.parse(this.res._headers['last-modified']) <= Date.parse(ifRange);\n};\n\n/**\n * Redirect to path.\n *\n * @param {string} path\n * @private\n */\n\nSendStream.prototype.redirect = function redirect(path) {\n  if (listenerCount(this, 'directory') !== 0) {\n    this.emit('directory')\n    return\n  }\n\n  if (this.hasTrailingSlash()) {\n    this.error(403)\n    return\n  }\n\n  var loc = path + '/'\n  var msg = 'Redirecting to <a href=\"' + escapeHtml(loc) + '\">' + escapeHtml(loc) + '</a>\\n'\n  var res = this.res\n\n  // redirect\n  res.statusCode = 301\n  res.setHeader('Content-Type', 'text/html; charset=UTF-8')\n  res.setHeader('Content-Length', Buffer.byteLength(msg))\n  res.setHeader('X-Content-Type-Options', 'nosniff')\n  res.setHeader('Location', loc)\n  res.end(msg)\n}\n\n/**\n * Pipe to `res.\n *\n * @param {Stream} res\n * @return {Stream} res\n * @api public\n */\n\nSendStream.prototype.pipe = function(res){\n  var self = this\n    , args = arguments\n    , root = this._root;\n\n  // references\n  this.res = res;\n\n  // decode the path\n  var path = decode(this.path)\n  if (path === -1) return this.error(400)\n\n  // null byte(s)\n  if (~path.indexOf('\\0')) return this.error(400);\n\n  var parts\n  if (root !== null) {\n    // malicious path\n    if (upPathRegexp.test(normalize('.' + sep + path))) {\n      debug('malicious path \"%s\"', path)\n      return this.error(403)\n    }\n\n    // join / normalize from optional root dir\n    path = normalize(join(root, path))\n    root = normalize(root + sep)\n\n    // explode path parts\n    parts = path.substr(root.length).split(sep)\n  } else {\n    // \"..\" is malicious without \"root\"\n    if (upPathRegexp.test(path)) {\n      debug('malicious path \"%s\"', path)\n      return this.error(403)\n    }\n\n    // explode path parts\n    parts = normalize(path).split(sep)\n\n    // resolve the path\n    path = resolve(path)\n  }\n\n  // dotfile handling\n  if (containsDotFile(parts)) {\n    var access = this._dotfiles\n\n    // legacy support\n    if (access === undefined) {\n      access = parts[parts.length - 1][0] === '.'\n        ? (this._hidden ? 'allow' : 'ignore')\n        : 'allow'\n    }\n\n    debug('%s dotfile \"%s\"', access, path)\n    switch (access) {\n      case 'allow':\n        break\n      case 'deny':\n        return this.error(403)\n      case 'ignore':\n      default:\n        return this.error(404)\n    }\n  }\n\n  // index file support\n  if (this._index.length && this.path[this.path.length - 1] === '/') {\n    this.sendIndex(path);\n    return res;\n  }\n\n  this.sendFile(path);\n  return res;\n};\n\n/**\n * Transfer `path`.\n *\n * @param {String} path\n * @api public\n */\n\nSendStream.prototype.send = function(path, stat){\n  var len = stat.size;\n  var options = this.options\n  var opts = {}\n  var res = this.res;\n  var req = this.req;\n  var ranges = req.headers.range;\n  var offset = options.start || 0;\n\n  if (res._header) {\n    // impossible to send now\n    return this.headersAlreadySent();\n  }\n\n  debug('pipe \"%s\"', path)\n\n  // set header fields\n  this.setHeader(path, stat);\n\n  // set content-type\n  this.type(path);\n\n  // conditional GET support\n  if (this.isConditionalGET()\n    && this.isCachable()\n    && this.isFresh()) {\n    return this.notModified();\n  }\n\n  // adjust len to start/end options\n  len = Math.max(0, len - offset);\n  if (options.end !== undefined) {\n    var bytes = options.end - offset + 1;\n    if (len > bytes) len = bytes;\n  }\n\n  // Range support\n  if (ranges) {\n    ranges = parseRange(len, ranges);\n\n    // If-Range support\n    if (!this.isRangeFresh()) {\n      debug('range stale');\n      ranges = -2;\n    }\n\n    // unsatisfiable\n    if (-1 == ranges) {\n      debug('range unsatisfiable');\n      res.setHeader('Content-Range', 'bytes */' + stat.size);\n      return this.error(416);\n    }\n\n    // valid (syntactically invalid/multiple ranges are treated as a regular response)\n    if (-2 != ranges && ranges.length === 1) {\n      debug('range %j', ranges);\n\n      // Content-Range\n      res.statusCode = 206;\n      res.setHeader('Content-Range', 'bytes '\n        + ranges[0].start\n        + '-'\n        + ranges[0].end\n        + '/'\n        + len);\n\n      offset += ranges[0].start;\n      len = ranges[0].end - ranges[0].start + 1;\n    }\n  }\n\n  // clone options\n  for (var prop in options) {\n    opts[prop] = options[prop]\n  }\n\n  // set read options\n  opts.start = offset\n  opts.end = Math.max(offset, offset + len - 1)\n\n  // content-length\n  res.setHeader('Content-Length', len);\n\n  // HEAD support\n  if ('HEAD' == req.method) return res.end();\n\n  this.stream(path, opts)\n};\n\n/**\n * Transfer file for `path`.\n *\n * @param {String} path\n * @api private\n */\nSendStream.prototype.sendFile = function sendFile(path) {\n  var i = 0\n  var self = this\n\n  debug('stat \"%s\"', path);\n  fs.stat(path, function onstat(err, stat) {\n    if (err && err.code === 'ENOENT'\n      && !extname(path)\n      && path[path.length - 1] !== sep) {\n      // not found, check extensions\n      return next(err)\n    }\n    if (err) return self.onStatError(err)\n    if (stat.isDirectory()) return self.redirect(self.path)\n    self.emit('file', path, stat)\n    self.send(path, stat)\n  })\n\n  function next(err) {\n    if (self._extensions.length <= i) {\n      return err\n        ? self.onStatError(err)\n        : self.error(404)\n    }\n\n    var p = path + '.' + self._extensions[i++]\n\n    debug('stat \"%s\"', p)\n    fs.stat(p, function (err, stat) {\n      if (err) return next(err)\n      if (stat.isDirectory()) return next()\n      self.emit('file', p, stat)\n      self.send(p, stat)\n    })\n  }\n}\n\n/**\n * Transfer index for `path`.\n *\n * @param {String} path\n * @api private\n */\nSendStream.prototype.sendIndex = function sendIndex(path){\n  var i = -1;\n  var self = this;\n\n  function next(err){\n    if (++i >= self._index.length) {\n      if (err) return self.onStatError(err);\n      return self.error(404);\n    }\n\n    var p = join(path, self._index[i]);\n\n    debug('stat \"%s\"', p);\n    fs.stat(p, function(err, stat){\n      if (err) return next(err);\n      if (stat.isDirectory()) return next();\n      self.emit('file', p, stat);\n      self.send(p, stat);\n    });\n  }\n\n  next();\n};\n\n/**\n * Stream `path` to the response.\n *\n * @param {String} path\n * @param {Object} options\n * @api private\n */\n\nSendStream.prototype.stream = function(path, options){\n  // TODO: this is all lame, refactor meeee\n  var finished = false;\n  var self = this;\n  var res = this.res;\n  var req = this.req;\n\n  // pipe\n  var stream = fs.createReadStream(path, options);\n  this.emit('stream', stream);\n  stream.pipe(res);\n\n  // response finished, done with the fd\n  onFinished(res, function onfinished(){\n    finished = true;\n    destroy(stream);\n  });\n\n  // error handling code-smell\n  stream.on('error', function onerror(err){\n    // request already finished\n    if (finished) return;\n\n    // clean up stream\n    finished = true;\n    destroy(stream);\n\n    // error\n    self.onStatError(err);\n  });\n\n  // end\n  stream.on('end', function onend(){\n    self.emit('end');\n  });\n};\n\n/**\n * Set content-type based on `path`\n * if it hasn't been explicitly set.\n *\n * @param {String} path\n * @api private\n */\n\nSendStream.prototype.type = function(path){\n  var res = this.res;\n  if (res.getHeader('Content-Type')) return;\n  var type = mime.lookup(path);\n  var charset = mime.charsets.lookup(type);\n  debug('content-type %s', type);\n  res.setHeader('Content-Type', type + (charset ? '; charset=' + charset : ''));\n};\n\n/**\n * Set response header fields, most\n * fields may be pre-defined.\n *\n * @param {String} path\n * @param {Object} stat\n * @api private\n */\n\nSendStream.prototype.setHeader = function setHeader(path, stat){\n  var res = this.res;\n\n  this.emit('headers', res, path, stat);\n\n  if (!res.getHeader('Accept-Ranges')) res.setHeader('Accept-Ranges', 'bytes');\n  if (!res.getHeader('Cache-Control')) res.setHeader('Cache-Control', 'public, max-age=' + Math.floor(this._maxage / 1000));\n\n  if (this._lastModified && !res.getHeader('Last-Modified')) {\n    var modified = stat.mtime.toUTCString()\n    debug('modified %s', modified)\n    res.setHeader('Last-Modified', modified)\n  }\n\n  if (this._etag && !res.getHeader('ETag')) {\n    var val = etag(stat)\n    debug('etag %s', val)\n    res.setHeader('ETag', val)\n  }\n};\n\n/**\n * Determine if path parts contain a dotfile.\n *\n * @api private\n */\n\nfunction containsDotFile(parts) {\n  for (var i = 0; i < parts.length; i++) {\n    if (parts[i][0] === '.') {\n      return true\n    }\n  }\n\n  return false\n}\n\n/**\n * decodeURIComponent.\n *\n * Allows V8 to only deoptimize this fn instead of all\n * of send().\n *\n * @param {String} path\n * @api private\n */\n\nfunction decode(path) {\n  try {\n    return decodeURIComponent(path)\n  } catch (err) {\n    return -1\n  }\n}\n\n/**\n * Normalize the index option into an array.\n *\n * @param {boolean|string|array} val\n * @param {string} name\n * @private\n */\n\nfunction normalizeList(val, name) {\n  var list = [].concat(val || [])\n\n  for (var i = 0; i < list.length; i++) {\n    if (typeof list[i] !== 'string') {\n      throw new TypeError(name + ' must be array of strings or false')\n    }\n  }\n\n  return list\n}\n"]}