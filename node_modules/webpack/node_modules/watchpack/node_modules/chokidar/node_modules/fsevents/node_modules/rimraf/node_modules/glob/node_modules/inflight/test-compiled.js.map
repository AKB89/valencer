{"version":3,"sources":["test.js"],"names":[],"mappings":"AAAA,IAAI,OAAO,QAAQ,KAAR,EAAe,IAA1B;AACA,IAAI,MAAM,QAAQ,eAAR,CAAV;;AAGA,SAAS,GAAT,CAAc,GAAd,EAAmB,EAAnB,EAAuB;AACrB,OAAK,IAAI,GAAJ,EAAS,EAAT,CAAL;AACA,MAAI,EAAJ,EAAQ,WAAW,YAAY;AAC7B,OAAG,GAAH;AACA,OAAG,GAAH;AACD,GAHO;AAIR,SAAO,EAAP;AACD;;AAED,KAAK,OAAL,EAAc,UAAU,CAAV,EAAa;AACzB,MAAI,UAAU,KAAd;AACA,MAAI,IAAI,IAAI,KAAJ,EAAW,UAAU,CAAV,EAAa;AAC9B,MAAE,KAAF,CAAQ,OAAR;AACA,cAAU,IAAV;AACA,MAAE,KAAF,CAAQ,CAAR,EAAW,KAAX;AACA,QAAI,OAAJ,EAAa,EAAE,GAAF;AACd,GALO,CAAR;AAMA,IAAE,EAAF,CAAK,CAAL,EAAQ,4BAAR;;AAEA,MAAI,UAAU,KAAd;AACA,MAAI,IAAI,IAAI,KAAJ,EAAW,UAAU,CAAV,EAAa;AAC9B,MAAE,KAAF,CAAQ,OAAR;AACA,cAAU,IAAV;AACA,MAAE,KAAF,CAAQ,CAAR,EAAW,KAAX;AACA,QAAI,OAAJ,EAAa,EAAE,GAAF;AACd,GALO,CAAR;;AAOA,IAAE,KAAF,CAAQ,CAAR,EAAW,4CAAX;AACD,CAnBD;;AAqBA,KAAK,QAAL,EAAe,UAAU,CAAV,EAAa;AAC1B,MAAI,SAAS,CACX,YADW,EAEX,WAFW,EAGX,SAHW,EAIX,KAJW,EAKX,MALW,EAMX,OANW,CAAb;AAQA,MAAI,IAAI,CAAR;;AAEA,WAAS,GAAT,CAAc,CAAd,EAAiB;AACf,MAAE,KAAF,CAAQ,CAAR,EAAW,OAAO,CAAP,CAAX,EAAsB,IAAI,OAAJ,GAAc,OAAO,CAAP,CAApC;AACA,MAAE,CAAF;AACA,QAAI,MAAM,OAAO,MAAjB,EACE,EAAE,GAAF;AACH;;AAED,WAAS,MAAT,CAAiB,IAAjB,EAAuB,EAAvB,EAA2B;AACzB,QAAI,YAAY,IAAhB;AACA,YAAQ,QAAR,CAAiB,EAAjB;AACD;;AAED,MAAI,MAAM,IAAI,KAAJ,EAAW,YAAY;AAC/B,QAAI,WAAJ;AACA,QAAI,QAAQ,IAAI,KAAJ,EAAW,YAAY;AACjC,UAAI,OAAJ;AACD,KAFW,CAAZ;AAGA,QAAI,KAAJ,EAAW,OAAO,OAAP,EAAgB,KAAhB;AACX,QAAI,SAAJ;AACD,GAPS,CAAV;;AASA,SAAO,KAAP,EAAc,GAAd;;AAEA,MAAI,MAAM,IAAI,KAAJ,EAAW,YAAY;AAC/B,QAAI,KAAJ;AACD,GAFS,CAAV;AAGA,MAAI,GAAJ,EAAS,OAAO,KAAP,EAAc,GAAd;;AAET,UAAQ,QAAR,CAAiB,IAAI,IAAJ,CAAS,IAAT,EAAe,MAAf,CAAjB;AACD,CAxCD;;AA0CA,KAAK,YAAL,EAAmB,UAAU,CAAV,EAAa;AAC9B,IAAE,IAAF,CAAO,CAAP;;AAEA,MAAI,IAAI,IAAI,KAAJ,EAAW,UAAU,KAAV,EAAiB,MAAjB,EAAyB,KAAzB,EAAgC;AACjD,MAAE,KAAF,CAAQ,KAAR,EAAe,CAAf;AACA,MAAE,KAAF,CAAQ,MAAR,EAAgB,CAAhB;AACA,MAAE,KAAF,CAAQ,KAAR,EAAe,CAAf;AACD,GAJO,CAAR;AAKA,IAAE,EAAF,CAAK,CAAL,EAAQ,4BAAR;;AAEA,MAAI,IAAI,IAAI,KAAJ,EAAW,UAAU,KAAV,EAAiB,MAAjB,EAAyB,KAAzB,EAAgC;AACjD,MAAE,KAAF,CAAQ,KAAR,EAAe,CAAf;AACA,MAAE,KAAF,CAAQ,MAAR,EAAgB,CAAhB;AACA,MAAE,KAAF,CAAQ,KAAR,EAAe,CAAf;AACD,GAJO,CAAR;AAKA,IAAE,KAAF,CAAQ,CAAR,EAAW,4CAAX;;AAEA,aAAW,YAAY;AACrB,MAAE,CAAF,EAAK,CAAL,EAAQ,CAAR;AACD,GAFD;AAGD,CApBD","file":"test-compiled.js","sourcesContent":["var test = require('tap').test\nvar inf = require('./inflight.js')\n\n\nfunction req (key, cb) {\n  cb = inf(key, cb)\n  if (cb) setTimeout(function () {\n    cb(key)\n    cb(key)\n  })\n  return cb\n}\n\ntest('basic', function (t) {\n  var calleda = false\n  var a = req('key', function (k) {\n    t.notOk(calleda)\n    calleda = true\n    t.equal(k, 'key')\n    if (calledb) t.end()\n  })\n  t.ok(a, 'first returned cb function')\n\n  var calledb = false\n  var b = req('key', function (k) {\n    t.notOk(calledb)\n    calledb = true\n    t.equal(k, 'key')\n    if (calleda) t.end()\n  })\n\n  t.notOk(b, 'second should get falsey inflight response')\n})\n\ntest('timing', function (t) {\n  var expect = [\n    'method one',\n    'start one',\n    'end one',\n    'two',\n    'tick',\n    'three'\n  ]\n  var i = 0\n\n  function log (m) {\n    t.equal(m, expect[i], m + ' === ' + expect[i])\n    ++i\n    if (i === expect.length)\n      t.end()\n  }\n\n  function method (name, cb) {\n    log('method ' + name)\n    process.nextTick(cb)\n  }\n\n  var one = inf('foo', function () {\n    log('start one')\n    var three = inf('foo', function () {\n      log('three')\n    })\n    if (three) method('three', three)\n    log('end one')\n  })\n\n  method('one', one)\n\n  var two = inf('foo', function () {\n    log('two')\n  })\n  if (two) method('one', two)\n\n  process.nextTick(log.bind(null, 'tick'))\n})\n\ntest('parameters', function (t) {\n  t.plan(8)\n\n  var a = inf('key', function (first, second, third) {\n    t.equal(first, 1)\n    t.equal(second, 2)\n    t.equal(third, 3)\n  })\n  t.ok(a, 'first returned cb function')\n\n  var b = inf('key', function (first, second, third) {\n    t.equal(first, 1)\n    t.equal(second, 2)\n    t.equal(third, 3)\n  })\n  t.notOk(b, 'second should get falsey inflight response')\n\n  setTimeout(function () {\n    a(1, 2, 3)\n  })\n})\n"]}