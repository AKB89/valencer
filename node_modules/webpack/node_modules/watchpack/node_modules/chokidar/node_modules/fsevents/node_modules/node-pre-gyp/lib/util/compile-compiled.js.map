{"version":3,"sources":["compile.js"],"names":[],"mappings":"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","file":"compile-compiled.js","sourcesContent":["\"use strict\";\n\nmodule.exports = exports;\n\nvar fs = require('fs');\nvar path = require('path');\nvar win = process.platform == 'win32';\nvar existsSync = fs.existsSync || path.existsSync;\nvar cp = require('child_process');\n\n// try to build up the complete path to node-gyp\n/* priority:\n  - node-gyp on ENV:npm_config_node_gyp (https://github.com/npm/npm/pull/4887)\n  - node-gyp on NODE_PATH\n  - node-gyp inside npm on NODE_PATH (ignore on iojs)\n  - node-gyp inside npm beside node exe\n*/\nfunction which_node_gyp() {\n    var node_gyp_bin;\n    if (process.env.npm_config_node_gyp) {\n      try {\n          node_gyp_bin = process.env.npm_config_node_gyp;\n          if (existsSync(node_gyp_bin)) {\n              return node_gyp_bin;\n          }\n      } catch (err) { }\n    }\n    try {\n        var node_gyp_main = require.resolve('node-gyp');\n        node_gyp_bin = path.join(path.dirname(\n                                     path.dirname(node_gyp_main)),\n                                     'bin/node-gyp.js');\n        if (existsSync(node_gyp_bin)) {\n            return node_gyp_bin;\n        }\n    } catch (err) { }\n    if (process.execPath.indexOf('iojs') === -1) {\n        try {\n            var npm_main = require.resolve('npm');\n            node_gyp_bin = path.join(path.dirname(\n                                         path.dirname(npm_main)),\n                                         'node_modules/node-gyp/bin/node-gyp.js');\n            if (existsSync(node_gyp_bin)) {\n                return node_gyp_bin;\n            }\n        } catch (err) { }\n    }\n    var npm_base = path.join(path.dirname(\n                             path.dirname(process.execPath)),\n                             'lib/node_modules/npm/');\n    node_gyp_bin = path.join(npm_base, 'node_modules/node-gyp/bin/node-gyp.js');\n    if (existsSync(node_gyp_bin)) {\n        return node_gyp_bin;\n    }\n}\n\nmodule.exports.run_gyp = function(args,opts,callback) {\n    var shell_cmd = '';\n    var cmd_args = [];\n    if (opts.runtime && opts.runtime == 'node-webkit') {\n        shell_cmd = 'nw-gyp';\n        if (win) shell_cmd += '.cmd';\n    } else {\n        var node_gyp_path = which_node_gyp();\n        if (node_gyp_path) {\n            shell_cmd = process.execPath;\n            cmd_args.push(node_gyp_path);\n        } else {\n            shell_cmd = 'node-gyp';\n            if (win) shell_cmd += '.cmd';\n        }\n    }\n    var final_args = cmd_args.concat(args);\n    var cmd = cp.spawn(shell_cmd, final_args, {cwd: undefined, env: process.env, stdio: [ 0, 1, 2]});\n    cmd.on('error', function (err) {\n        if (err) {\n            return callback(new Error(\"Failed to execute '\" + shell_cmd + ' ' + final_args.join(' ') + \"' (\" + err + \")\"));\n        }\n        callback(null,opts);\n    });\n    cmd.on('close', function (code) {\n        if (code && code !== 0) {\n            return callback(new Error(\"Failed to execute '\" + shell_cmd + ' ' + final_args.join(' ') + \"' (\" + code + \")\"));\n        }\n        callback(null,opts);\n    });\n};\n"]}