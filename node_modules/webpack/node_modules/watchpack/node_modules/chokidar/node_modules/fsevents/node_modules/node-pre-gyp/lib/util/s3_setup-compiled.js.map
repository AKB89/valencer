{"version":3,"sources":["s3_setup.js"],"names":[],"mappings":"AAAA;;AAEA,OAAO,OAAP,GAAiB,OAAjB;;AAEA,IAAI,MAAM,QAAQ,KAAR,CAAV;;AAEA,IAAI,YAAU,sCAAd;;AAEA,OAAO,OAAP,CAAe,MAAf,GAAwB,UAAS,EAAT,EAAY,MAAZ,EAAoB;AACxC,QAAI,MAAM,IAAI,KAAJ,CAAU,EAAV,CAAV;AACA,QAAI,mBAAmB,IAAI,QAAJ,CAAa,KAAb,CAAmB,SAAnB,CAAvB;AACA,WAAO,MAAP,GAAiB,CAAC,IAAI,QAAL,IAAiB,IAAI,QAAJ,IAAgB,GAAlC,GAAyC,EAAzC,GAA8C,IAAI,QAAJ,CAAa,OAAb,CAAqB,GAArB,EAAyB,EAAzB,CAA9D;AACA,QAAG,CAAC,gBAAJ,EAAsB;AAClB;AACH;AACD,QAAI,CAAC,OAAO,MAAZ,EAAoB;AAChB,eAAO,MAAP,GAAgB,iBAAiB,CAAjB,CAAhB;AACH;AACD,QAAI,CAAC,OAAO,MAAZ,EAAoB;AAChB,YAAI,YAAY,iBAAiB,CAAjB,CAAhB;AACA,YAAI,UAAU,KAAV,CAAgB,CAAhB,EAAkB,CAAlB,KAAwB,KAAxB,IACA,UAAU,MAAV,IAAoB,CADxB,EAC2B;;AAEvB,mBAAO,MAAP,GAAgB,UAAU,OAAV,CAAkB,KAAlB,EAAwB,EAAxB,CAAhB;AACH;AACJ;AACJ,CAlBD","file":"s3_setup-compiled.js","sourcesContent":["\"use strict\";\n\nmodule.exports = exports;\n\nvar url = require('url');\n\nvar URI_REGEX=\"^(.*)\\.(s3(?:-.*)?)\\.amazonaws\\.com$\";\n\nmodule.exports.detect = function(to,config) {\n    var uri = url.parse(to);\n    var hostname_matches = uri.hostname.match(URI_REGEX);\n    config.prefix = (!uri.pathname || uri.pathname == '/') ? '' : uri.pathname.replace('/','');\n    if(!hostname_matches) {\n        return;\n    }\n    if (!config.bucket) {\n        config.bucket = hostname_matches[1];\n    }\n    if (!config.region) {\n        var s3_domain = hostname_matches[2];\n        if (s3_domain.slice(0,3) == 's3-' &&\n            s3_domain.length >= 3) {\n            // it appears the region is explicit in the url\n            config.region = s3_domain.replace('s3-','');\n        }\n    }\n};\n"]}