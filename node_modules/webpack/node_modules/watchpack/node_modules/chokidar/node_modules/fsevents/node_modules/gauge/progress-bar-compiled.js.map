{"version":3,"sources":["progress-bar.js"],"names":[],"mappings":"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","file":"progress-bar-compiled.js","sourcesContent":["\"use strict\"\nvar hasUnicode = require(\"has-unicode\")\nvar ansi = require(\"ansi\")\nvar align = {\n  center: require(\"lodash.pad\"),\n  left:   require(\"lodash.padend\"),\n  right:  require(\"lodash.padstart\")\n}\nvar defaultStream = process.stderr\nfunction isTTY() {\n  return process.stderr.isTTY\n}\nfunction getWritableTTYColumns() {\n  // Writing to the final column wraps the line\n  // We have to use stdout here, because Node's magic SIGWINCH handler only\n  // updates process.stdout, not process.stderr\n  return process.stdout.columns - 1\n}\n\nvar ProgressBar = module.exports = function (options, cursor) {\n  if (! options) options = {}\n  if (! cursor && options.write) {\n    cursor = options\n    options = {}\n  }\n  if (! cursor) {\n    cursor = ansi(defaultStream)\n  }\n  this.cursor = cursor\n  this.showing = false\n  this.theme = options.theme || (hasUnicode() ? ProgressBar.unicode : ProgressBar.ascii)\n  this.template = options.template || [\n    {type: \"name\", separated: true, length: 25},\n    {type: \"spinner\", separated: true},\n    {type: \"startgroup\"},\n    {type: \"completionbar\"},\n    {type: \"endgroup\"}\n  ]\n  this.updatefreq = options.maxUpdateFrequency == null ? 50 : options.maxUpdateFrequency\n  this.lastName = \"\"\n  this.lastCompleted = 0\n  this.spun = 0\n  this.last = new Date(0)\n\n  var self = this\n  this._handleSizeChange = function () {\n    if (!self.showing) return\n    self.hide()\n    self.show()\n  }\n}\nProgressBar.prototype = {}\n\nProgressBar.unicode = {\n  startgroup: \"╢\",\n  endgroup: \"╟\",\n  complete: \"█\",\n  incomplete: \"░\",\n  spinner: \"▀▐▄▌\",\n  subsection: \"→\"\n}\n\nProgressBar.ascii = {\n  startgroup: \"|\",\n  endgroup: \"|\",\n  complete: \"#\",\n  incomplete: \"-\",\n  spinner: \"-\\\\|/\",\n  subsection: \"->\"\n}\n\nProgressBar.prototype.setTheme = function(theme) {\n  this.theme = theme\n}\n\nProgressBar.prototype.setTemplate = function(template) {\n  this.template = template\n}\n\nProgressBar.prototype._enableResizeEvents = function() {\n  process.stdout.on('resize', this._handleSizeChange)\n}\n\nProgressBar.prototype._disableResizeEvents = function() {\n  process.stdout.removeListener('resize', this._handleSizeChange)\n}\n\nProgressBar.prototype.disable = function() {\n  this.hide()\n  this.disabled = true\n}\n\nProgressBar.prototype.enable = function() {\n  this.disabled = false\n  this.show()\n}\n\nProgressBar.prototype.hide = function() {\n  if (!isTTY()) return\n  if (this.disabled) return\n  this.cursor.show()\n  if (this.showing) this.cursor.up(1)\n  this.cursor.horizontalAbsolute(0).eraseLine()\n  this.showing = false\n}\n\nvar repeat = function (str, count) {\n  var out = \"\"\n  for (var ii=0; ii<count; ++ii) out += str\n  return out\n}\n\nProgressBar.prototype.pulse = function(name) {\n  ++ this.spun\n  if (! this.showing) return\n  if (this.disabled) return\n\n  var baseName = this.lastName\n  name = name\n       ? ( baseName\n         ? baseName + \" \" + this.theme.subsection + \" \" + name\n         : null )\n       : baseName\n  this.show(name)\n  this.lastName = baseName\n}\n\nProgressBar.prototype.show = function(name, completed) {\n  name = this.lastName = name || this.lastName\n  completed = this.lastCompleted = completed || this.lastCompleted\n\n  if (!isTTY()) return\n  if (this.disabled) return\n  if (! this.spun && ! completed) return\n  if (this.tryAgain) return\n  var self = this\n\n  if (this.showing && new Date() - this.last < this.updatefreq) {\n    this.tryAgain = setTimeout(function () {\n      self.tryAgain = null\n      if (self.disabled) return\n      if (! self.spun && ! completed) return\n      drawBar()\n    }, this.updatefreq - (new Date() - this.last))\n    return\n  }\n\n  return drawBar()\n\n  function drawBar() {\n    var values = {\n      name: name,\n      spinner: self.spun,\n      completed: completed\n    }\n\n    self.last = new Date()\n\n    var statusline = self.renderTemplate(self.theme, self.template, values)\n\n    if (self.showing) self.cursor.up(1)\n    self.cursor\n        .hide()\n        .horizontalAbsolute(0)\n        .write(statusline.substr(0, getWritableTTYColumns()) + \"\\n\")\n        .show()\n\n    self.showing = true\n  }\n}\n\nProgressBar.prototype.renderTemplate = function (theme, template, values) {\n  values.startgroup = theme.startgroup\n  values.endgroup = theme.endgroup\n  values.spinner = values.spinner\n    ? theme.spinner.substr(values.spinner % theme.spinner.length,1)\n    : \"\"\n\n  var output = {prebar: \"\", postbar: \"\"}\n  var status = \"prebar\"\n  var self = this\n  template.forEach(function(T) {\n    if (typeof T === \"string\") {\n      output[status] += T\n      return\n    }\n    if (T.type === \"completionbar\") {\n      status = \"postbar\"\n      return\n    }\n    if (!values.hasOwnProperty(T.type)) throw new Error(\"Unknown template value '\"+T.type+\"'\")\n    var value = self.renderValue(T, values[T.type])\n    if (value === \"\") return\n    var sofar = output[status].length\n    var lastChar = sofar ? output[status][sofar-1] : null\n    if (T.separated && sofar && lastChar !== \" \") {\n      output[status] += \" \"\n    }\n    output[status] += value\n    if (T.separated) output[status] += \" \"\n  })\n\n  var bar = \"\"\n  if (status === \"postbar\") {\n    var nonBarLen = output.prebar.length + output.postbar.length\n\n    var barLen = getWritableTTYColumns() - nonBarLen\n    var sofar = Math.round(barLen * Math.max(0,Math.min(1,values.completed||0)))\n    var rest = barLen - sofar\n    bar = repeat(theme.complete, sofar)\n        + repeat(theme.incomplete, rest)\n  }\n\n  return output.prebar + bar + output.postbar\n}\nProgressBar.prototype.renderValue = function (template, value) {\n  if (value == null || value === \"\") return \"\"\n  var maxLength = template.maxLength || template.length\n  var minLength = template.minLength || template.length\n  var alignWith = align[template.align] || align.left\n//  if (maxLength) value = value.substr(-1 * maxLength)\n  if (maxLength) value = value.substr(0, maxLength)\n  if (minLength) value = alignWith(value, minLength)\n  return value\n}\n"]}