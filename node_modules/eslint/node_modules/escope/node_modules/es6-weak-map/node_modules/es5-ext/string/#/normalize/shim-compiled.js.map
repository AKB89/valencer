{"version":3,"sources":["shim.js"],"names":[],"mappings":"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","file":"shim-compiled.js","sourcesContent":["// Taken from: https://github.com/walling/unorm/blob/master/lib/unorm.js\n\n/*\n\t* UnicodeNormalizer 1.0.0\n\t* Copyright (c) 2008 Matsuza\n\t* Dual licensed under the MIT (MIT-LICENSE.txt) and\n\t* GPL (GPL-LICENSE.txt) licenses.\n\t* $Date: 2008-06-05 16:44:17 +0200 (Thu, 05 Jun 2008) $\n\t* $Rev: 13309 $\n*/\n\n'use strict';\n\nvar primitiveSet = require('../../../object/primitive-set')\n  , validValue   = require('../../../object/valid-value')\n  , data         = require('./_data')\n\n  , floor = Math.floor\n  , forms = primitiveSet('NFC', 'NFD', 'NFKC', 'NFKD')\n\n  , DEFAULT_FEATURE = [null, 0, {}], CACHE_THRESHOLD = 10, SBase = 0xAC00\n  , LBase = 0x1100, VBase = 0x1161, TBase = 0x11A7, LCount = 19, VCount = 21\n  , TCount = 28, NCount = VCount * TCount, SCount = LCount * NCount\n  , UChar, cache = {}, cacheCounter = [], i, fromCache, fromData, fromCpOnly\n  , fromRuleBasedJamo, fromCpFilter, strategies, UCharIterator\n  , RecursDecompIterator, DecompIterator, CompIterator, createIterator\n  , normalize;\n\nUChar = function (cp, feature) {\n\tthis.codepoint = cp;\n\tthis.feature = feature;\n};\n\n// Strategies\nfor (i = 0; i <= 0xFF; ++i) cacheCounter[i] = 0;\n\nfromCache = function (next, cp, needFeature) {\n\tvar ret = cache[cp];\n\tif (!ret) {\n\t\tret = next(cp, needFeature);\n\t\tif (!!ret.feature && ++cacheCounter[(cp >> 8) & 0xFF] > CACHE_THRESHOLD) {\n\t\t\tcache[cp] = ret;\n\t\t}\n\t}\n\treturn ret;\n};\n\nfromData = function (next, cp, needFeature) {\n\tvar hash = cp & 0xFF00, dunit = UChar.udata[hash] || {}, f = dunit[cp];\n\treturn f ? new UChar(cp, f) : new UChar(cp, DEFAULT_FEATURE);\n};\nfromCpOnly = function (next, cp, needFeature) {\n\treturn !!needFeature ? next(cp, needFeature) : new UChar(cp, null);\n};\n\nfromRuleBasedJamo = function (next, cp, needFeature) {\n\tvar c, base, i, arr, SIndex, TIndex, feature, j;\n\tif (cp < LBase || (LBase + LCount <= cp && cp < SBase) ||\n\t\t\t(SBase + SCount < cp)) {\n\t\treturn next(cp, needFeature);\n\t}\n\tif (LBase <= cp && cp < LBase + LCount) {\n\t\tc = {};\n\t\tbase = (cp - LBase) * VCount;\n\t\tfor (i = 0; i < VCount; ++i) {\n\t\t\tc[VBase + i] = SBase + TCount * (i + base);\n\t\t}\n\t\tarr = new Array(3);\n\t\tarr[2] = c;\n\t\treturn new UChar(cp, arr);\n\t}\n\n\tSIndex = cp - SBase;\n\tTIndex = SIndex % TCount;\n\tfeature = [];\n\tif (TIndex !== 0) {\n\t\tfeature[0] = [SBase + SIndex - TIndex, TBase + TIndex];\n\t} else {\n\t\tfeature[0] = [LBase + floor(SIndex / NCount), VBase +\n\t\t\tfloor((SIndex % NCount) / TCount)];\n\t\tfeature[2] = {};\n\t\tfor (j = 1; j < TCount; ++j) {\n\t\t\tfeature[2][TBase + j] = cp + j;\n\t\t}\n\t}\n\treturn new UChar(cp, feature);\n};\n\nfromCpFilter = function (next, cp, needFeature) {\n\treturn (cp < 60) || ((13311 < cp) && (cp < 42607))\n\t\t? new UChar(cp, DEFAULT_FEATURE) : next(cp, needFeature);\n};\n\nstrategies = [fromCpFilter, fromCache, fromCpOnly, fromRuleBasedJamo, fromData];\n\nUChar.fromCharCode = strategies.reduceRight(function (next, strategy) {\n\treturn function (cp, needFeature) { return strategy(next, cp, needFeature); };\n}, null);\n\nUChar.isHighSurrogate = function (cp) { return cp >= 0xD800 && cp <= 0xDBFF; };\nUChar.isLowSurrogate = function (cp) { return cp >= 0xDC00 && cp <= 0xDFFF; };\n\nUChar.prototype.prepFeature = function () {\n\tif (!this.feature) {\n\t\tthis.feature = UChar.fromCharCode(this.codepoint, true).feature;\n\t}\n};\n\nUChar.prototype.toString = function () {\n\tvar x;\n\tif (this.codepoint < 0x10000) return String.fromCharCode(this.codepoint);\n\tx = this.codepoint - 0x10000;\n\treturn String.fromCharCode(floor(x / 0x400) + 0xD800, x % 0x400 + 0xDC00);\n};\n\nUChar.prototype.getDecomp = function () {\n\tthis.prepFeature();\n\treturn this.feature[0] || null;\n};\n\nUChar.prototype.isCompatibility = function () {\n\tthis.prepFeature();\n\treturn !!this.feature[1] && (this.feature[1] & (1 << 8));\n};\nUChar.prototype.isExclude = function () {\n\tthis.prepFeature();\n\treturn !!this.feature[1] && (this.feature[1] & (1 << 9));\n};\nUChar.prototype.getCanonicalClass = function () {\n\tthis.prepFeature();\n\treturn !!this.feature[1] ? (this.feature[1] & 0xff) : 0;\n};\nUChar.prototype.getComposite = function (following) {\n\tvar cp;\n\tthis.prepFeature();\n\tif (!this.feature[2]) return null;\n\tcp = this.feature[2][following.codepoint];\n\treturn cp ? UChar.fromCharCode(cp) : null;\n};\n\nUCharIterator = function (str) {\n\tthis.str = str;\n\tthis.cursor = 0;\n};\nUCharIterator.prototype.next = function () {\n\tif (!!this.str && this.cursor < this.str.length) {\n\t\tvar cp = this.str.charCodeAt(this.cursor++), d;\n\t\tif (UChar.isHighSurrogate(cp) && this.cursor < this.str.length &&\n\t\t\t\tUChar.isLowSurrogate((d = this.str.charCodeAt(this.cursor)))) {\n\t\t\tcp = (cp - 0xD800) * 0x400 + (d - 0xDC00) + 0x10000;\n\t\t\t++this.cursor;\n\t\t}\n\t\treturn UChar.fromCharCode(cp);\n\t}\n\tthis.str = null;\n\treturn null;\n};\n\nRecursDecompIterator = function (it, cano) {\n\tthis.it = it;\n\tthis.canonical = cano;\n\tthis.resBuf = [];\n};\n\nRecursDecompIterator.prototype.next = function () {\n\tvar recursiveDecomp, uchar;\n\trecursiveDecomp = function (cano, uchar) {\n\t\tvar decomp = uchar.getDecomp(), ret, i, a, j;\n\t\tif (!!decomp && !(cano && uchar.isCompatibility())) {\n\t\t\tret = [];\n\t\t\tfor (i = 0; i < decomp.length; ++i) {\n\t\t\t\ta = recursiveDecomp(cano, UChar.fromCharCode(decomp[i]));\n\t\t\t\t//ret.concat(a); //<-why does not this work?\n\t\t\t\t//following block is a workaround.\n\t\t\t\tfor (j = 0; j < a.length; ++j) ret.push(a[j]);\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\treturn [uchar];\n\t};\n\tif (this.resBuf.length === 0) {\n\t\tuchar = this.it.next();\n\t\tif (!uchar) return null;\n\t\tthis.resBuf = recursiveDecomp(this.canonical, uchar);\n\t}\n\treturn this.resBuf.shift();\n};\n\nDecompIterator = function (it) {\n\tthis.it = it;\n\tthis.resBuf = [];\n};\n\nDecompIterator.prototype.next = function () {\n\tvar cc, uchar, inspt, uchar2, cc2;\n\tif (this.resBuf.length === 0) {\n\t\tdo {\n\t\t\tuchar = this.it.next();\n\t\t\tif (!uchar) break;\n\t\t\tcc = uchar.getCanonicalClass();\n\t\t\tinspt = this.resBuf.length;\n\t\t\tif (cc !== 0) {\n\t\t\t\tfor (inspt; inspt > 0; --inspt) {\n\t\t\t\t\tuchar2 = this.resBuf[inspt - 1];\n\t\t\t\t\tcc2 = uchar2.getCanonicalClass();\n\t\t\t\t\tif (cc2 <= cc) break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.resBuf.splice(inspt, 0, uchar);\n\t\t} while (cc !== 0);\n\t}\n\treturn this.resBuf.shift();\n};\n\nCompIterator = function (it) {\n\tthis.it = it;\n\tthis.procBuf = [];\n\tthis.resBuf = [];\n\tthis.lastClass = null;\n};\n\nCompIterator.prototype.next = function () {\n\tvar uchar, starter, composite, cc;\n\twhile (this.resBuf.length === 0) {\n\t\tuchar = this.it.next();\n\t\tif (!uchar) {\n\t\t\tthis.resBuf = this.procBuf;\n\t\t\tthis.procBuf = [];\n\t\t\tbreak;\n\t\t}\n\t\tif (this.procBuf.length === 0) {\n\t\t\tthis.lastClass = uchar.getCanonicalClass();\n\t\t\tthis.procBuf.push(uchar);\n\t\t} else {\n\t\t\tstarter = this.procBuf[0];\n\t\t\tcomposite = starter.getComposite(uchar);\n\t\t\tcc = uchar.getCanonicalClass();\n\t\t\tif (!!composite && (this.lastClass < cc || this.lastClass === 0)) {\n\t\t\t\tthis.procBuf[0] = composite;\n\t\t\t} else {\n\t\t\t\tif (cc === 0) {\n\t\t\t\t\tthis.resBuf = this.procBuf;\n\t\t\t\t\tthis.procBuf = [];\n\t\t\t\t}\n\t\t\t\tthis.lastClass = cc;\n\t\t\t\tthis.procBuf.push(uchar);\n\t\t\t}\n\t\t}\n\t}\n\treturn this.resBuf.shift();\n};\n\ncreateIterator = function (mode, str) {\n\tswitch (mode) {\n\tcase \"NFD\":\n\t\treturn new DecompIterator(\n\t\t\tnew RecursDecompIterator(new UCharIterator(str), true)\n\t\t);\n\tcase \"NFKD\":\n\t\treturn new DecompIterator(\n\t\t\tnew RecursDecompIterator(new UCharIterator(str), false)\n\t\t);\n\tcase \"NFC\":\n\t\treturn new CompIterator(new DecompIterator(\n\t\t\tnew RecursDecompIterator(new UCharIterator(str), true)\n\t\t));\n\tcase \"NFKC\":\n\t\treturn new CompIterator(new DecompIterator(\n\t\t\tnew RecursDecompIterator(new UCharIterator(str), false)\n\t\t));\n\t}\n\tthrow mode + \" is invalid\";\n};\nnormalize = function (mode, str) {\n\tvar it = createIterator(mode, str), ret = \"\", uchar;\n\twhile (!!(uchar = it.next())) ret += uchar.toString();\n\treturn ret;\n};\n\n/* Unicode data */\nUChar.udata =  data;\n\nmodule.exports = function (/*form*/) {\n\tvar str = String(validValue(this)), form = arguments[0];\n\tif (form === undefined) form = 'NFC';\n\telse form = String(form);\n\tif (!forms[form]) throw new RangeError('Invalid normalization form: ' + form);\n\treturn normalize(form, str);\n};\n"]}