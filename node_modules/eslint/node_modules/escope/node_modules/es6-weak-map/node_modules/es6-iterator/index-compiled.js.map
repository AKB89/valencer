{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nvar clear    = require('es5-ext/array/#/clear')\n  , assign   = require('es5-ext/object/assign')\n  , callable = require('es5-ext/object/valid-callable')\n  , value    = require('es5-ext/object/valid-value')\n  , d        = require('d')\n  , autoBind = require('d/auto-bind')\n  , Symbol   = require('es6-symbol')\n\n  , defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , Iterator;\n\nmodule.exports = Iterator = function (list, context) {\n\tif (!(this instanceof Iterator)) return new Iterator(list, context);\n\tdefineProperties(this, {\n\t\t__list__: d('w', value(list)),\n\t\t__context__: d('w', context),\n\t\t__nextIndex__: d('w', 0)\n\t});\n\tif (!context) return;\n\tcallable(context.on);\n\tcontext.on('_add', this._onAdd);\n\tcontext.on('_delete', this._onDelete);\n\tcontext.on('_clear', this._onClear);\n};\n\ndefineProperties(Iterator.prototype, assign({\n\tconstructor: d(Iterator),\n\t_next: d(function () {\n\t\tvar i;\n\t\tif (!this.__list__) return;\n\t\tif (this.__redo__) {\n\t\t\ti = this.__redo__.shift();\n\t\t\tif (i !== undefined) return i;\n\t\t}\n\t\tif (this.__nextIndex__ < this.__list__.length) return this.__nextIndex__++;\n\t\tthis._unBind();\n\t}),\n\tnext: d(function () { return this._createResult(this._next()); }),\n\t_createResult: d(function (i) {\n\t\tif (i === undefined) return { done: true, value: undefined };\n\t\treturn { done: false, value: this._resolve(i) };\n\t}),\n\t_resolve: d(function (i) { return this.__list__[i]; }),\n\t_unBind: d(function () {\n\t\tthis.__list__ = null;\n\t\tdelete this.__redo__;\n\t\tif (!this.__context__) return;\n\t\tthis.__context__.off('_add', this._onAdd);\n\t\tthis.__context__.off('_delete', this._onDelete);\n\t\tthis.__context__.off('_clear', this._onClear);\n\t\tthis.__context__ = null;\n\t}),\n\ttoString: d(function () { return '[object Iterator]'; })\n}, autoBind({\n\t_onAdd: d(function (index) {\n\t\tif (index >= this.__nextIndex__) return;\n\t\t++this.__nextIndex__;\n\t\tif (!this.__redo__) {\n\t\t\tdefineProperty(this, '__redo__', d('c', [index]));\n\t\t\treturn;\n\t\t}\n\t\tthis.__redo__.forEach(function (redo, i) {\n\t\t\tif (redo >= index) this.__redo__[i] = ++redo;\n\t\t}, this);\n\t\tthis.__redo__.push(index);\n\t}),\n\t_onDelete: d(function (index) {\n\t\tvar i;\n\t\tif (index >= this.__nextIndex__) return;\n\t\t--this.__nextIndex__;\n\t\tif (!this.__redo__) return;\n\t\ti = this.__redo__.indexOf(index);\n\t\tif (i !== -1) this.__redo__.splice(i, 1);\n\t\tthis.__redo__.forEach(function (redo, i) {\n\t\t\tif (redo > index) this.__redo__[i] = --redo;\n\t\t}, this);\n\t}),\n\t_onClear: d(function () {\n\t\tif (this.__redo__) clear.call(this.__redo__);\n\t\tthis.__nextIndex__ = 0;\n\t})\n})));\n\ndefineProperty(Iterator.prototype, Symbol.iterator, d(function () {\n\treturn this;\n}));\ndefineProperty(Iterator.prototype, Symbol.toStringTag, d('', 'Iterator'));\n"]}